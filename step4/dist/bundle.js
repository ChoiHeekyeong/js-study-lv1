(()=>{"use strict";const e={items:[],idx:-1};var t=(t,n)=>`\n      <li>\n        ${n===e.idx?`<form name="modifierForm" action="">\n          <fieldset>\n            <legend hidden>아이템 수정</legend>\n            <label>\n              <span hidden>아이템 수정</span>\n              <input type="text" value="${t.content}" size="40">\n            </label>\n            <button type="submit">완료</button>\n            <button type="button" class="cancle">취소</button>\n          </fieldset>\n        </form>`:`<p ${t.isComplete?' style="color:#09F"':""}>\n        <input type="checkbox" \n        class="complete" data-key="${n}" \n        ${t.isComplete?"checked":""}/>\n        ${t.content}\n      </p>\n      <button type="button">취소</button>\n      <button type="button" class="modifier" data-key="${n}">수정</button>\n      <button type="button" class="remover" data-key="${n}">삭제</button>`}\n    </li>\n`,n=function(t){t.preventDefault();const n=document.querySelector("#app").querySelector('form[name="appenderForm"]'),o=n.querySelector("input").value.trim();if(0===o.length)return alert("enter content");e.items.push({id:e.items.length,content:n.querySelector("input").value,isComplete:!1,createtime:Date.now()}),function(e="",t={}){return fetch(e,{method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},redirect:"follow",referrer:"no-referrer",body:JSON.stringify(t)}).then((e=>e.json()))}("/app/items",{content:o}).then((e=>console.log(JSON.stringify(e)))).catch((e=>console.error(e))),l()},o=function(t){e.idx=Number(t.target.dataset.key),l()},r=function(t){t.preventDefault();const n=t.target.querySelector("input").value.trim();if(0===n.length)return alert("enter content");e.items[e.idx].content=n,fetch(`/app/items/${e.idx+1}`,{method:"PUT",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},redirect:"follow",referrer:"no-referrer",body:JSON.stringify({content:n})}).then((e=>e.json())).then(console.log("updated completed!")),e.idx=-1,l()},i=function(t){t.preventDefault(),e.idx=-1,l()},c=function(t){const n=Number(t.target.dataset.key);e.items.splice(n,1),fetch(`app/items/${n+1}`,{method:"DELETE",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},redirect:"follow",referrer:"no-referrer"}).then((e=>e.json())).then(console.log("item removed!")),l()},a=function(t){const n=Number(t.target.dataset.key),o=e.items[n];o.isComplete=!o.isComplete,l()},l=async function(){await fetch("/app/items",{method:"GET",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},redirect:"follow",referrer:"no-referrer"}).then((e=>e.json())).then((function(t){for(let n=0;n<t.length;++n)e.items[n]=t[n];console.log("1",e.items)}));const s=document.querySelector("#app");s.innerHTML=`\n<main id="app">\n <h1>📃 TodoList</h1>\n <form name="appenderForm" action="" method="post">\n   <fieldset>\n     <legend hidden>TodoList Form</legend>\n     <label>\n       <span hidden>아이템 추가</span>\n       <input type="text" size="40" placeholder="Todo Item 내용을 입력해주세요">\n     </label>\n     <button type="submit">전송</button>\n   </fieldset>\n </form>\n <ul>\n   ${e.items.map(t).join("")}\n </ul>\n</main>\n`,s.querySelector('form[name="appenderForm"]').addEventListener("submit",n),s.querySelectorAll(".modifier").forEach((function(e){e.addEventListener("click",o)})),s.querySelector('form[name="modifierForm"]')?.addEventListener("submit",r),s.querySelector('form[name="modifierForm"]')?.addEventListener("keyup",(function(t){"Escape"==t.key&&(e.idx=-1,l())})),s.querySelectorAll(".remover").forEach((function(e){e.addEventListener("click",c)})),s.querySelectorAll(".complete").forEach((function(e){e.addEventListener("click",a)})),s.querySelectorAll(".cancle").forEach((function(e){e.addEventListener("click",i)}))};l()})();